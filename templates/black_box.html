{% extends "base.html" %}

{% block title %}Black Box Challenge - Mini Games{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-10">
        <div class="text-center mb-4">
            <h1 class="display-5 fw-bold text-primary">üì¶ Black Box Challenge</h1>
            <p class="lead">Discover the hidden mathematical rule!</p>
        </div>

        <!-- Game Status -->
        <div class="row mb-4">
            <div class="col-3">
                <div class="card text-center">
                    <div class="card-body py-2">
                        <small class="text-muted">Tests</small>
                        <div class="fw-bold" id="tests-count">0</div>
                    </div>
                </div>
            </div>
            <div class="col-3">
                <div class="card text-center">
                    <div class="card-body py-2">
                        <small class="text-muted">Guesses</small>
                        <div class="fw-bold" id="guesses-count">0</div>
                    </div>
                </div>
            </div>
            <div class="col-3">
                <div class="card text-center">
                    <div class="card-body py-2">
                        <small class="text-muted">Difficulty</small>
                        <div class="fw-bold" id="difficulty-level">Medium</div>
                    </div>
                </div>
            </div>
            <div class="col-3">
                <div class="card text-center">
                    <div class="card-body py-2">
                        <small class="text-muted">Status</small>
                        <div class="fw-bold text-warning" id="game-status">Analyzing</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Area -->
        <div class="card game-area mb-4">
            <div class="card-body">
                <!-- Instructions -->
                <div id="instructions" class="text-center mb-4">
                    <h4>How to Play</h4>
                    <p>There's a hidden mathematical rule that transforms input numbers into outputs.</p>
                    <p>Use the examples provided and test your own inputs to figure out the pattern.</p>
                    <p class="text-muted">Once you think you know the rule, select it from the options below!</p>
                    <button class="btn btn-primary" onclick="startGame()">Start Game</button>
                </div>

                <!-- Game Play Area -->
                <div id="game-play" class="d-none">
                    <div class="row">
                        <div class="col-lg-8">
                            <!-- Examples Section -->
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h6 class="mb-0">üìã Given Examples</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row" id="examples-container">
                                        <!-- Examples will be populated here -->
                                    </div>
                                </div>
                            </div>

                            <!-- Test Section -->
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h6 class="mb-0">üß™ Test Your Own Inputs</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row align-items-end mb-3">
                                        <div class="col-4">
                                            <label for="test-input" class="form-label">Input:</label>
                                            <input type="number" id="test-input" class="form-control" placeholder="Enter number">
                                        </div>
                                        <div class="col-4">
                                            <label class="form-label">Output:</label>
                                            <div id="test-output" class="form-control bg-light">--</div>
                                        </div>
                                        <div class="col-4">
                                            <button class="btn btn-primary w-100" onclick="testInput()">
                                                <i class="fas fa-play"></i> Test
                                            </button>
                                        </div>
                                    </div>

                                    <!-- Test History -->
                                    <div id="test-history" class="d-none">
                                        <h6 class="text-muted">Your Tests:</h6>
                                        <div class="table-responsive">
                                            <table class="table table-sm">
                                                <thead>
                                                    <tr>
                                                        <th>Input</th>
                                                        <th>Output</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="test-history-body">
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Rule Selection -->
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">üéØ Select the Hidden Rule</h6>
                                </div>
                                <div class="card-body">
                                    <div id="rule-options">
                                        <!-- Rule options will be populated here -->
                                    </div>
                                    <div class="text-center mt-3">
                                        <button class="btn btn-success" onclick="submitGuess()">
                                            <i class="fas fa-check"></i> Submit Guess
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4">
                            <!-- Analysis Helper -->
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">üîç Analysis Helper</h6>
                                </div>
                                <div class="card-body">
                                    <div id="pattern-hints">
                                        <p class="small text-muted">Look for patterns in:</p>
                                        <ul class="small">
                                            <li>Sum of digits</li>
                                            <li>Product of digits</li>
                                            <li>Number of digits</li>
                                            <li>Even/odd patterns</li>
                                            <li>Arithmetic operations</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Strategy Tips -->
                            <div class="card mt-3">
                                <div class="card-header">
                                    <h6 class="mb-0">üí° Strategy Tips</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li>Test simple numbers first (1, 2, 3)</li>
                                        <li>Try numbers with different digit counts</li>
                                        <li>Test edge cases (0, negative numbers if allowed)</li>
                                        <li>Look for mathematical relationships</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Feedback Area -->
                    <div id="feedback-area" class="text-center mt-4 d-none">
                        <div id="feedback-message" class="alert" role="alert"></div>
                    </div>
                </div>

                <!-- Game Complete -->
                <div id="game-complete" class="text-center d-none">
                    <h3 id="game-result" class="mb-3"></h3>
                    <p class="lead" id="completion-message"></p>
                    <div id="rule-explanation" class="alert alert-info"></div>
                    <div class="d-flex gap-2 justify-content-center">
                        <button class="btn btn-primary" onclick="startGame()">
                            <i class="fas fa-redo"></i> Play Again
                        </button>
                        <a href="{{ url_for('home') }}" class="btn btn-outline-secondary">
                            <i class="fas fa-home"></i> Home
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/black_box.js') }}"></script>
{% endblock %}

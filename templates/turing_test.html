{% extends "base.html" %}

{% block title %}∎ TURING TEST - {{ difficulty.upper() }} MODE ∎{% endblock %}

{% block content %}
<div style="text-align: center; margin-bottom: 40px;">
    <h1 class="matrix-text">∎ NEURAL TURING PROTOCOL ∎</h1>
    <p style="color: var(--star-white); font-size: 1.1rem;">
        Detect artificial consciousness from organic intelligence...
    </p>
</div>

<div class="status-display">
    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
        <div class="level-display">ROUND: <span id="current-round">1</span> / <span id="total-rounds">5</span></div>
        <div class="score-display">SCORE: <span id="current-score">0</span></div>
        <div style="color: var(--magic-pink);">DIFFICULTY: {{ difficulty.upper() }}</div>
    </div>
</div>

<div style="background: linear-gradient(135deg, var(--space-dark), var(--universe-purple)); border: 2px solid var(--magic-cyan); border-radius: 12px; padding: 25px; margin: 20px 0;">
    <h3 style="color: var(--magic-cyan); margin-bottom: 20px; text-align: center;">∎ CONSCIOUSNESS ANALYSIS ∎</h3>
    
    <div id="question-display" style="color: var(--star-white); font-size: 1.2rem; margin-bottom: 30px; text-align: center; background: rgba(0,0,0,0.5); padding: 20px; border-radius: 8px;">
        Initializing neural analysis protocols...
    </div>
    
    <div id="responses-container">
        <div id="response-a" style="background: rgba(0,255,65,0.1); border: 1px solid var(--terminal-green); border-radius: 8px; padding: 20px; margin: 15px 0; cursor: pointer;" onclick="selectResponse('human')">
            <strong style="color: var(--terminal-green);">Response A:</strong>
            <div style="color: var(--star-white); margin-top: 10px;">Loading...</div>
        </div>
        
        <div id="response-b" style="background: rgba(114,9,183,0.1); border: 1px solid var(--magic-violet); border-radius: 8px; padding: 20px; margin: 15px 0; cursor: pointer;" onclick="selectResponse('ai')">
            <strong style="color: var(--magic-violet);">Response B:</strong>
            <div style="color: var(--star-white); margin-top: 10px;">Loading...</div>
        </div>
    </div>
    
    <div style="text-align: center; margin: 30px 0;">
        <p style="color: var(--quantum-glow);">Which response was generated by AI?</p>
        <button id="reveal-btn" class="cosmic-btn" style="display: none;">
            <i class="fas fa-eye"></i> REVEAL_ANSWER
        </button>
    </div>
</div>

<div style="text-align: center; margin: 30px 0;">
    <a href="/games" class="cosmic-btn" style="background: linear-gradient(45deg, var(--void-gray), var(--space-dark));">
        <i class="fas fa-arrow-left"></i> RETURN_TO_BASE
    </a>
</div>
{% endblock %}

{% block scripts %}
<script>
class TuringTestGame {
    constructor() {
        this.difficulty = '{{ difficulty }}';
        this.currentRound = 1;
        this.score = 0;
        this.totalRounds = this.difficulty === 'hard' ? 7 : this.difficulty === 'medium' ? 5 : 3;
        this.selectedAnswer = null;
        this.correctAnswer = null;
        
        this.questions = [
            "What's your favorite way to spend a weekend?",
            "How do you feel about rainy days?",
            "What makes you laugh?",
            "Describe your ideal vacation",
            "What's your biggest fear?"
        ];
        
        this.humanResponses = [
            "I love sleeping in and maybe catching up with friends over coffee. Sometimes I'll binge-watch a show I've been putting off.",
            "Honestly, I find them pretty cozy. Perfect excuse to stay inside with hot chocolate and a good book.",
            "Silly videos of animals doing weird things. Also my friends' terrible jokes - they're so bad they're good!",
            "Somewhere warm with a beach, but not too crowded. I want to relax but also try the local food scene.",
            "Probably not living up to my potential, or my family getting hurt. Pretty standard stuff I guess."
        ];
        
        this.aiResponses = [
            "Optimal weekend activities include efficient rest cycles and engaging in knowledge acquisition through various media consumption platforms.",
            "Precipitation events create favorable atmospheric conditions for indoor productivity and contemplative activities with warm beverages.",
            "Humorous content typically involves unexpected logical inversions or anthropomorphized non-human entities displaying incongruent behaviors.",
            "An ideal recreational period would feature optimal solar exposure, minimal population density, and diverse culinary data sampling opportunities.",
            "Risk assessment suggests concern regarding performance optimization failures and potential harm to primary social network connections."
        ];
        
        this.init();
    }
    
    init() {
        document.getElementById('total-rounds').textContent = this.totalRounds;
        this.nextRound();
    }
    
    nextRound() {
        if (this.currentRound > this.totalRounds) {
            this.endGame();
            return;
        }
        
        document.getElementById('current-round').textContent = this.currentRound;
        
        const questionIndex = Math.floor(Math.random() * this.questions.length);
        const question = this.questions[questionIndex];
        const humanResponse = this.humanResponses[questionIndex];
        const aiResponse = this.aiResponses[questionIndex];
        
        // Randomly assign which is A and which is B
        this.correctAnswer = Math.random() < 0.5 ? 'human' : 'ai';
        
        document.getElementById('question-display').textContent = `"${question}"`;
        
        if (this.correctAnswer === 'human') {
            document.getElementById('response-a').querySelector('div').textContent = humanResponse;
            document.getElementById('response-b').querySelector('div').textContent = aiResponse;
        } else {
            document.getElementById('response-a').querySelector('div').textContent = aiResponse;
            document.getElementById('response-b').querySelector('div').textContent = humanResponse;
        }
        
        // Reset UI
        this.selectedAnswer = null;
        document.getElementById('reveal-btn').style.display = 'none';
        document.querySelectorAll('#responses-container div').forEach(div => {
            div.style.borderWidth = '1px';
            div.style.boxShadow = 'none';
        });
    }
    
    selectResponse(choice) {
        this.selectedAnswer = choice;
        
        // Highlight selected response
        document.querySelectorAll('#responses-container div').forEach(div => {
            div.style.borderWidth = '1px';
            div.style.boxShadow = 'none';
        });
        
        const selectedElement = choice === 'human' ? document.getElementById('response-a') : document.getElementById('response-b');
        selectedElement.style.borderWidth = '3px';
        selectedElement.style.boxShadow = '0 0 20px var(--quantum-glow)';
        
        document.getElementById('reveal-btn').style.display = 'inline-block';
        document.getElementById('reveal-btn').onclick = () => this.checkAnswer();
    }
    
    checkAnswer() {
        if (!this.selectedAnswer) return;
        
        const isCorrect = (this.selectedAnswer === 'human' && this.correctAnswer === 'ai') || 
                         (this.selectedAnswer === 'ai' && this.correctAnswer === 'human');
        
        if (isCorrect) {
            this.score += Math.floor(100 * (this.difficulty === 'hard' ? 2 : this.difficulty === 'medium' ? 1.5 : 1));
            document.getElementById('current-score').textContent = this.score;
            this.showFeedback("✅ CORRECT! AI detected successfully!", 'success');
        } else {
            this.showFeedback("❌ INCORRECT! The AI fooled you this time.", 'error');
        }
        
        setTimeout(() => {
            this.currentRound++;
            this.nextRound();
        }, 2500);
    }
    
    showFeedback(message, type) {
        const feedback = document.createElement('div');
        feedback.textContent = message;
        feedback.style.cssText = `
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: ${type === 'success' ? 'var(--terminal-green)' : 'var(--magic-pink)'};
            color: var(--cosmic-black); padding: 20px 30px; border-radius: 10px;
            font-weight: bold; z-index: 2000; font-size: 1.2rem;
            box-shadow: 0 0 40px ${type === 'success' ? 'var(--terminal-green)' : 'var(--magic-pink)'};
        `;
        
        document.body.appendChild(feedback);
        setTimeout(() => document.body.removeChild(feedback), 2500);
    }
    
    endGame() {
        showCosmicSuccess('Turing Test', this.score, 
            `You completed ${this.currentRound - 1} consciousness analyses! AI detection protocol finished.`);
    }
}

document.addEventListener('DOMContentLoaded', function() {
    new TuringTestGame();
});
</script>
{% endblock %}